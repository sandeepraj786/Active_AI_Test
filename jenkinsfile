pipeline {
   agent any
   stages {
	   stage('SCM Checkout'){
             steps{    
		   git 'https://github.com/sandeepraj786/Active_AI_Test.git'
		 }
	    }
      stage('passing the parameter'){
          steps{
             script{
              properties([
                 parameters ([
                    choice(name: 'App_Name', choices: ['morfeus','runtime','training'], description: ''),
                    choice(name: 'Service_Name', choices: ['morfeusadmin','morfeus-app','sniper-worker','triniti-worker'], description: ''),
		    string(name: 'AWS_ECR_ID', defaultValue: "nginx", description: 'image  to be used'),

                 ])
               
    

              ])   
            }

          }
       }
      
         
      stage('Run Ansible playbook') {
               steps {
	         script{
	               if (App_Name =="morfeus" && Service_Name=="morfeusadmin"){
                     sh "ansible-playbook /var/lib/jenkins/workspace/Active-Ai-Test-Job/ansible/deploy-chatbot-ai.yml   --extra-vars 'env=${App_Name} app=$Service_Name image=${AWS_ECR_ID} '"

                  }else{
                     sh "ansible-playbook /var/lib/jenkins/workspace/Active-Ai-Test-Job/ansible/deploy-chatbot2-ai.yml   --extra-vars 'env=${App_Name} app=$Service_Name '"

                  }
		 } 
                     
	             
         }
       }
    }
}
